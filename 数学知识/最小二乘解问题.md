==超定方程==是指方程组个数大于未知量个数的方程组。对于方程组Ra=y，R为m*n矩阵，如果R列满秩，且m>n。则方程组没有精确解，此时称方程组为超定方程组。
## 投影矩阵与最小二乘
- 线形代数角度
将样本数据代入假设函数中，构建线性方程组Ax=b。若样本个数明显多于特征维度，则b很有可能没有落在A的列空间中，因此方程组无解。此时，可以取 $A^{T}·A·x’=A^{T}·b$ ，将b投影到A的列空间中，求解投影向量所对应的x’。所以，一旦采用A转置的处理，求解的系数x’仅仅是原方程最小二乘解
>原理：==一个向量b垂直于一个子空间，则这个向量也垂直于构成这个子空间的所有的基向量。==
>一个向量垂直于子空间的所有基向量，则这个向量到这个子空间内的向量Ax是最短的。
>求解Ax= b
>Ax=-b的最佳估计，此时将投影过程中产生的法向量e认为是误差，被从原始b中减去，得到投影向量p。但需要格外注意的是，采用这种方法的前提是A的列向量必须满秩，保证 ($A^T·A$) 可逆。这样$A^T·A$就是一个实对称矩阵，则方程一定有解。求得的解为投影近似解。
- 统计学角度
在线性回归中通常认为误差项仅仅出现在y的维度上，而特征维度x间不存在任何误差，所以，将样本数据代入假设函数，只站在y的角度定义损失函数 $e^{2}=\sum_{} ^{} {(Ax-b)^2 }$然后对x分别取偏导数=0，最小化 e^2 ，最后发现取完偏导数=0后的方程组与前文中投影后的方程组相同，数学真的是很神奇！

求得 x’=(A^T·A)^{-1}·A^T·b 。
## 最小二乘解
#### ==齐次方程组==
目标：min||Ax|| 
约束条件：||x|| = 1
目标函数：||Ax|| 
$\lambda$为A'A的最小特征值。也是A的奇异值分解的对角矩阵对应的向量。
||Ax|| = x'A'Ax = x'$\lambda$x = $\lambda$||x||，其中$\lambda$是A'A的特征值。
![enter image description here](https://github.com/HotView/Images/raw/f0bb0e95cc96b8ea655086c46d6703319d6eacab/TIM%E6%88%AA%E5%9B%BE20190325224801.png)
- 令y=$V^Tx$ ,则问题变为：min||Dy|| ；st：||y|| = 1。
- 由于$\sum$是一个对角矩阵，对角元素按降序排列，因此最优解在y=(0,0,...,1)T时取得，又因为$x=Vy$， 所以最优解就是V的最小奇异值对应的列向量，比如，最小奇异值在第6行6列，那么x 为 V的第6个列向量。
- 当x取最后一列向量时，其对应的奇异值最小，等号成立。因为，x与V的距离最短的条件是：Ax-b这个向量垂直于所有的子空间的向量。Ax属于子空间。
>Ax是子空间的一个向量，可以用子空间基向量的线性组合来表示。

在线性方程的求解或是数据曲线拟合中，利用最小二乘法求得的解则被称为最小二乘解。最小二乘法（又称最小平方法）是一种数学优化技术，它通过最小化误差的平方和寻找数据的最佳函数匹配。其他一些优化问题也可通过最小化能量或最大化熵用最小二乘法来表达。
- 线性方程组
![](https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/s=251/sign=aab4efe38c18367aa98978d81f718b68/6c224f4a20a44623131287a89222720e0df3d71b.jpg)
可能无解。即任意一组  都可能使![enter image description here](https://gss1.bdstatic.com/9vo3dSag_xI4khGkpoWK1HF6hhy/baike/s=266/sign=99dd10005b3d26972ad30f5b63fab24f/14ce36d3d539b60003c2227de350352ac75cb7ef.jpg)

我们设法找到${x_1}^0,{x_2}^0.....{x_s}^0$  使![enter image description here](https://gss3.bdstatic.com/-Po3dSag_xI4khGkpoWK1HF6hhy/baike/s=239/sign=6f1f1bc151b5c9ea66f304e0ec38b622/8c1001e93901213fe38a63165ee736d12e2e95ba.jpg)  最小，这样的 ${x_1}^0,{x_2}^0.....{x_s}^0$称为方程组的最小二乘解。这种问题叫做最小二乘问题。

使得![enter image description here](https://gss3.bdstatic.com/-Po3dSag_xI4khGkpoWK1HF6hhy/baike/s=239/sign=6f1f1bc151b5c9ea66f304e0ec38b622/8c1001e93901213fe38a63165ee736d12e2e95ba.jpg)最小其实就是在$L(\alpha_1,\alpha_2.....\alpha_s)$中找到一向量Y = AX，使得B到它的距离比到子空间L中其他的向量点积为零。

这时，AX的模长取得最小值，也就是在x投影在A空间之后其模长是最小的，也就是离远点最近。
#### ==非齐次方程组==
Ax = b；这时直接将b投影到AT 的空间中去，即两边同时乘以AT，然后就可以用B的列空间向量来表示AT *b这个向量了；这时方程有唯一解，因为【AT \*A】是可逆矩阵的距离都短。满足以上条件，则C= B-Y必须垂直于子空间L，则只须且必须$（C ,\alpha_1）,（C ,\alpha_2）....（C ,\alpha_s） = 0$。即：![](https://gss0.bdstatic.com/94o3dSag_xI4khGkpoWK1HF6hhy/baike/s=216/sign=0de81d133301213fcb3349dd62e536f8/574e9258d109b3de1c7acda2c6bf6c81810a4c36.jpg)
则A'C = 0；即A'（B-AX） = 0。即A'AX = A'B。
上式是一个线形方程，系数矩阵是：A'A，常数项是A'B。
## 最小二乘解的原理
#### 定理1（存在性）
方程组必存在最小二乘解，且a是方程组的最小二乘解的充要条件是a是RT·R·a=RT·y的解。
#### 定理2（唯一性）
若rank(R)=r<m，则方程组有无穷多个最小二乘解，其中2-范数最小的解称为方程组的极小最小二乘解，且该解是唯一的，为a'=GT(GGT)-1(FTF)-1FTy
#### 定理3（唯一性）
若rank(R)=m<=n，以上超定方程组存在唯一最小二乘解，解为a=(RT·R)-1·RT·y
考虑线性方程组**_Ax_**=**_b_**, 求其最小二乘解.

#### 最小二乘解
最小二乘解所满足的代数方程，它是一个线性方程，系数矩阵是 $A'A$ ，常数项是  $A'B$，这种线性方程总是有解的。

对于齐次线性方程组**Ax**=0。当**A**行数大于列数时，需要求解最小二乘解。在||**x**||=1的约束下，其最小二乘解为矩阵**A'A**最小特征值所对应的特征向量。求解方法有两种(matlab)：
-  [V ，$\lambda$] = $eig(A'A)$；$\lambda$为$A'A$的特征值对角矩阵，V为对应的特征向量。找到最小特征值对应的V中的特征向量即为最小二乘解。
- 使用SVD分解矩阵A，[U S V] = svd(A); U由$AA'$的特征向量组成，V由$A'A$的特征向量组成。因此，奇异值矩阵S中最小的奇异值对应的V中的奇异向量即为最小二乘解。


> Written with [StackEdit](https://stackedit.io/).
<!--stackedit_data:
eyJoaXN0b3J5IjpbNjE1MjE4MzIsOTA2MjYxNTUxLDEyODU1OD
Y1NTQsLTE2NzUyNDUwMjZdfQ==
-->