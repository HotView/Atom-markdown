VPN：virtual private network（虚拟专用网络）
### 背景介绍：
- 很多的公司具有全球化业务，它们在世界各个区域都有设备。但是随之面临的问题是：==怎么建立一种有效的安全的可信赖的连接在各个区域之间==。
- 最近才出现的概念：可靠通信意味着使用租用线路维护−区域网络（WAN：Wide-Area Network）租用的线路，范围从综合服务数字网络(ISDN，运行速度为144kbps)到光载波−3 (OC3运行在155 Mbps)纤维,为公司提供一种扩大他们的私人网络超出了他们直接的地理区域。
- 广域网在可靠性、性能和安全性方面明显优于Internet等公共网络;但是维护广域网，特别是使用租用线路时，可能会变得相当昂贵
- （it often rises in cost as the distance between offices increase）通常成本会随着距离的增加而增加。
- 此外，对于部分员工流动性很强(比如营销人员)、可能经常需要远程连接公司网络并访问敏感数据的组织来说，租用线路不是可行的解决方案。
- 随着互联网的普及，企业已经将其作为扩展自己网络的一种手段。首先是内部网，这是专为公司员工设计的网站。现在，许多公司创建自己的虚拟专用网(vpn)来满足远程员工和办公室的需求。
### 概念介绍：
一个典型的VPN可能由一个主要的（LAN）在公司的总部，其他的LANs在远端的办公区域或设备，外部连接的个人用户三部分组成。
![在这里插入图片描述](https://img-blog.csdnimg.cn/2019010516093520.png?x-ossprocess=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4NDg1NTAx,size_16,color_FFFFFF,t_70)
VPN是一种专用网络，它使用公共网络(通常是Internet)将远程站点或用户连接在一起。而不是使用一个专用的,真正的−世界连接,如专线。
### VPN类型
两种：
- Remote-Access：也称为虚拟专用拨号−网络(VPDN),这是一个用户−−局域网连接使用的公司的员工需要从不同的远程连接到私有网络。
- Site-to-site：通过使用专用设备和大型−规模加密,一个公司可以连接多个固定站点在互联网等公共网络。每个站点只需要一个本地连接相同的公共网络,从而节省私人出租−线长。

### 类比的故事：每一个局域网都是一个岛
- 想象一下我们生活在一个巨大海洋的小岛上。有成千上万的岛屿在你的岛屿周围，一些离得近，一些离得远。通常的旅行方式是从你的岛乘渡船到你想去的任何一个岛。乘渡船旅行意味着你几乎没有隐私。你做的任何事都可能被别人看到。
- 假设每个岛屿代表一个私有局域网，海洋就是互联网。当你乘坐轮渡旅行时，它类似于你通过互联网连接到一个web服务器或另一个设备。你无法控制构成互联网的线路和路由器，就像你无法控制渡轮上的其他人一样。如果您试图使用公共资源在两个私有网络之间连接，这将使您容易受到安全问题的影响。
- 你的岛决定建造一座通往另一个岛的桥梁，这样人们在这两个岛之间旅行就会更容易、更安全、更直接。即使你所连接的岛离你很近，建造和维护这座桥的费用还是很高的。但是对一个可靠、安全的路径的需求是如此之大，以至于您无论如何都要这样做。你的岛想要连接到另一个岛，这个要远得多，但你认为它太贵了。
- 这种情况很像租用线路。这些桥(租用的线路)与海洋分开(互联网)，但他们能够连接岛屿(局域网)。许多公司选择这条路线，是因为在连接远程办公室时需要安全性和可靠性。相距很远,但是,如果办公室的费用可以支付高额−就像试图建立一座桥梁横跨一个伟大的距离。
- 那么VPN如何适应这个类比呢?我们可以给我们岛屿上的每个居民一个小型潜水艇作为他们的私有财产。
这样有如下的优点：
	1. 快速。
	2. 想去哪就很方便。
	3. 从任何的船只和潜水艇隐藏你。
	4. 独立的。
	5. 一旦购买了潜水艇，之后的花费就很少了。

- 虽然他们和其他交通工具一起在海洋中旅行，但我们两个岛屿的居民可以在他们想要的任何时候在隐私和安全的情况下来回旅行。这就是VPN的工作原理。您的网络中的每个远程成员都可以使用internet作为连接到专用LAN的媒介，以安全可靠的方式进行通信。VPN可以比租用线路更容易适应更多的用户和不同的位置。事实上，可伸缩性是vpn相对于典型的租用线路的一个主要优势。与租用线路的成本随着距离的增加而增加不同，在VPN的创建过程中，每个办公室的地理位置无关紧要。

### VPN技术
一个好的VPN技术通常使用几种不同的方法来保证数据的安全。
- 数据机密性
这可能是VPN实现提供的最重要的服务。由于您的私有数据通过公共网络传输，因此数据机密性非常重要，可以通过加密数据来实现。这是将一台计算机发送给另一台计算机的所有数据编码成只有另一台计算机能够解码的形式的过程。
几种加密技术：
	1. IPsec
	2. PPTP/MPPE
	3. L2TP/IPsec

- 数据完整性（数据有没有被更改）
虽然在公共网络上对数据进行加密很重要，但同样重要的是验证数据在传输过程中没有被更改。例如，IPsec有一种机制来确保数据包的加密部分，或者数据包的整个报头和数据部分没有被篡改。如果检测到篡改，则丢弃数据包。数据完整性还包括对远程对等点进行身份验证。
- 数据来源认证
验证发送的数据源的身份非常重要。这对于防范一些依赖于欺骗发送方身份的攻击是必要的。
- 抗重播
这是一种检测和拒绝重放数据包的能力，有助于防止欺骗。
- 数据隧道/交通流机密性
隧道是将整个包封装在另一个包中并通过网络发送它的过程。在需要隐藏发起通信流的设备的标识的情况下，数据隧道非常有用。例如，一个使用IPsec的设备封装了它背后属于多个主机的流量，并在现有数据包上添加了自己的报头。通过加密原始数据包和报头(并基于在其上添加的额外第3层报头路由数据包)，隧道设备有效地隐藏了实际的报头数据包的来源。
这里列出的所有加密协议也都使用隧道作为在公共网络上传输加密数据的一种方法。重要的是要认识到，隧道本身并不提供数据安全性。原包仅仅是封装在另一个协议和可能仍然可见与包−捕获设备如果没有加密。然而，这里提到了它，因为它是VPNs功能不可分割的一部分。
隧道需要三种不同的协议
	1. Passenger protocol
	2. Encapsulating protocol
	3. Carrier protocol

	site-to-site:对于网站−−网站vpn,通常是IPsec或通用路由封装协议封装(GRE)。GRE包括关于您正在封装的包的类型的信息以及关于客户机和服务器之间的连接的信息。
	remote-to-acess:为远程−访问vpn隧道通常使用点−−点协议(PPP)。作为TCP/IP协	议栈的一部分，当主机和远程系统通过网络进行通信时，PPP是其他IP协议的载体。PPP隧道将使用PPTP, L2TP或
Cisco的Layer 2 Forwarding (L2F)

- AAA
身份验证、授权和会计是用来更安全的访问远程−访问VPN环境中。没有用户身份验证,谁坐在笔记本电脑/ PC pre−配置VPN客户端软件可以建立一个安全连接到远程网络。但是，对于用户身份验证，在连接完成之前还必须输入有效的用户名和密码。用户名和密码可以存储在VPN终端设备本身上，也可以存储在外部AAA服务器上，它可以为Windows NT、Novell、LDAP等许多其他数据库提供身份验证
	1. Who you are(Authentication)
	2. What you are allowed to do(authorization)
	3. What you actually do(Accounting)
- 不可抵赖性
在某些数据传输中，尤其是与金融交易相关的数据传输中，不可抵赖性是非常可取的特性。这有助于防止一方否认参与交易的情况。就像银行在兑现支票之前需要您的签名一样，不可抵赖性的工作原理是在发送的消息上附加一个数字签名，从而排除了这种可能性发送方拒绝参与交易的可能性。

### VPN产品
针对两种不同的类型，你需要某些组件来构建你的VPN
- 远程用户的客户端
- 专用硬件，如Cisco VPN集中器或Cisco安全PIX防火墙
- 用VPN服务器为表盘−服务
- 服务提供商用于远程用户VPN访问的网络访问服务器(NAS)
- 专用网络和策略管理中心

这方面的知识可以网上详细查询思科公司提出的几种解决方案。
### 什么是SS（shadowsocks）
---
Shadowsocks的运行原理与其他代理工具基本相同，使用特定的中转服务器完成数据传输。

在服务器端部署完成后，用户需要按照指定的密码、加密方式和端口，使用客户端软件与其连接。在成功连接到服务器后，客户端会在本机上构建一个本地Socks5代理（或VPN、透明代理）。浏览网络时，网络流量会被分到本地Socks5代理，客户端将其加密之后发送到服务器，服务器以同样的加密方式将流量回传给客户端，以此实现代理上网。
### 附录
翻译自google的某篇大神的PDF，PDF信息如下：
title：How Virtual Private Networks Work
Document ID: 14106

> Written with [StackEdit](https://stackedit.io/).
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTU0NjAxNzQzMV19
-->